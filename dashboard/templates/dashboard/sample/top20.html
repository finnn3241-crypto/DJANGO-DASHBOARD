{% load humanize %}

<style>
/* ===== TOP 20 CUSTOMERS SECTION STYLES ===== */

/* Gold Header Bar */
.sectionHeaderBar.gold {
  margin: 40px 0 20px 0;
  padding: 12px 32px;
  background: linear-gradient(90deg, #fef3c7, #fde68a);
  text-align: center;
  font-weight: 700;
  font-size: 18px;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: #0f172a;
  border-radius: 12px;
  box-shadow: 0 4px 6px rgba(15, 23, 42, 0.05);
}

/* ===== TABLET RESPONSIVE (max-width: 1024px) ===== */
@media (max-width: 1024px) {
  .sectionHeaderBar.gold {
    margin: 32px 0 16px 0;
    padding: 10px 24px;
    font-size: 16px;
  }
}

/* ===== MOBILE RESPONSIVE (max-width: 768px) ===== */
@media (max-width: 768px) {
  .sectionHeaderBar.gold {
    margin: 28px 0 16px 0;
    padding: 10px 20px;
    font-size: 14px;
    letter-spacing: 0.1em;
    border-radius: 10px;
  }
}

/* ===== SMALL MOBILE (max-width: 480px) ===== */
@media (max-width: 480px) {
  .sectionHeaderBar.gold {
    margin: 24px 0 12px 0;
    padding: 8px 16px;
    font-size: 13px;
    letter-spacing: 0.05em;
    border-radius: 8px;
  }
}

/* ===== EXTRA SMALL SCREENS (max-width: 360px) ===== */
@media (max-width: 360px) {
  .sectionHeaderBar.gold {
    font-size: 12px;
    padding: 8px 12px;
  }
}
</style>

<!-- TOP 20 CUSTOMERS SECTION -->
<div class="sectionHeaderBar gold">Top 20 Customers</div>

<div class="cardRowContainer">

  <!-- PREVIOUS DAY CARD -->
  <div class="dashCard">
    <div class="cardHeader prevDay">Previous Day</div>

    <!-- Reason Wise -->
    <div class="tableWrapper">
      <table class="dataTable">
        {% for r in top20.prev_reason %}
        <tr>
          <td class="labelCell">{{ r.reason }}</td>
          <td class="valueCell">Qty {{ r.qty|floatformat:"0"|intcomma }}</td>
          <td class="valueCell">Rs. {{ r.amount|floatformat:"0"|intcomma }} @ {{ rate }} P.Kg</td>
          <td class="valueCell percentCell">{{ r.per }}%</td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <div class="sectionDivider"></div>

    <!-- Customer Wise -->
    <div class="sectionTitle">Customer Wise</div>
    <div class="tableWrapper">
      <table class="dataTable">
        {% for c in top20.prev_customer %}
        <tr>
          <td class="labelCell">{{ c.customer }}</td>
          <td class="valueCell">Qty {{ c.qty|floatformat:"0"|intcomma }}</td>
          <td class="valueCell">Rs. {{ c.amount|floatformat:"0"|intcomma }} @ {{ rate }} P.Kg</td>
          <td class="valueCell percentCell">{{ c.per }}%</td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <div class="sectionDivider"></div>

    <!-- Category Wise -->
    <div class="sectionTitle">Category Wise</div>
    <div class="tableWrapper">
      <table class="dataTable">
        {% for c in top20.category_prev %}
        <tr>
          <td class="labelCell">{{ c.category }}</td>
          <td class="valueCell">Qty {{ c.qty|floatformat:"0"|intcomma }}</td>
          <td class="valueCell">Rs. {{ c.amount|floatformat:"0"|intcomma }} @ {{ rate }} P.Kg</td>
          <td class="valueCell percentCell">{{ c.per }}%</td>
        </tr>
        {% endfor %}
      </table>
    </div>
  </div>

  <!-- CURRENT MONTH CARD -->
  <div class="dashCard">
    <div class="cardHeader currMonth">Current Month</div>

    <!-- Reason Wise -->
    <div class="tableWrapper">
      <table class="dataTable">
        {% for r in top20.curr_reason %}
        <tr>
          <td class="labelCell">{{ r.reason }}</td>
          <td class="valueCell">Qty {{ r.qty|floatformat:"0"|intcomma }}</td>
          <td class="valueCell">Rs. {{ r.amount|floatformat:"0"|intcomma }} @ {{ rate }} P.Kg</td>
          <td class="valueCell percentCell">{{ r.per }}%</td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <div class="sectionDivider"></div>

    <!-- Customer Wise -->
    <div class="sectionTitle">Customer Wise</div>
    <div class="tableWrapper">
      <table class="dataTable">
        {% for c in top20.curr_customer %}
        <tr>
          <td class="labelCell">{{ c.customer }}</td>
          <td class="valueCell">Qty {{ c.qty|floatformat:"0"|intcomma }}</td>
          <td class="valueCell">Rs. {{ c.amount|floatformat:"0"|intcomma }} @ {{ rate }} P.Kg</td>
          <td class="valueCell percentCell">{{ c.per }}%</td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <div class="sectionDivider"></div>

    <!-- Article / Color Dispatched -->
    <div class="sectionTitle">Article / Color Dispatched to Same Customer</div>
    <div class="tableWrapper">
      <table class="dataTable">
        {% for a in top20.article_color %}
        <tr>
          <td class="labelCell">{{ a.customer }}</td>
          <td class="labelCell">{{ a.style_color }}</td>
          <td class="valueCell">Count {{ a.cnt }}</td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <div class="sectionDivider"></div>

    <!-- Category Wise -->
    <div class="sectionTitle">Category Wise</div>
    <div class="tableWrapper">
      <table class="dataTable">
        {% for c in top20.category_month %}
        <tr>
          <td class="labelCell">{{ c.category }}</td>
          <td class="valueCell">Qty {{ c.qty|floatformat:"0"|intcomma }}</td>
          <td class="valueCell">Rs. {{ c.amount|floatformat:"0"|intcomma }} @ {{ rate }} P.Kg</td>
          <td class="valueCell percentCell">{{ c.per }}%</td>
        </tr>
        {% endfor %}
      </table>
    </div>
  </div>

</div>